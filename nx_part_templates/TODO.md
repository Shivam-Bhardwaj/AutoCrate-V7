QUICK REFERENCE FOR NX EXPRESSION LINKING (AutoCrate Skids & Floorboards)
=========================================================================

**Objective:** Use the expressions from the imported 'AutoCrate_Expressions.exp' file
(generated by the Streamlit app) to parametrically drive skids and floorboards
in your NX assembly (e.g., within 'BASE_ASSY_TEMPLATE.prt').

**Prerequisites:**
1. Streamlit app has generated/updated 'AutoCrate_Expressions.exp'.
2. 'AutoCrate_Expressions.exp' has been imported into your active NX assembly
   (e.g., '_MAIN_CRATE_ASSEMBLY.prt' or 'BASE_ASSY_TEMPLATE.prt' if expressions are passed down).
3. Your `SKID_LUMBER_TEMPLATE.prt` has internal expressions:
   - INPUT_Skid_Width
   - INPUT_Skid_Length
   - INPUT_Skid_Height
4. Your `FLOORBOARD_LUMBER_TEMPLATE.prt` has internal expressions:
   - INPUT_Floorboard_Length_X
   - INPUT_Floorboard_Width_Y
   - INPUT_Floorboard_Thickness_Z
   - And its origin is defined (e.g., center of bottom face).

-------------------------------------------------------------------------
SECTION 1: SKID SETUP (Using NX Pattern Component)
-------------------------------------------------------------------------

**A. Key Assembly Expressions from `.exp` File (for Skids):**
   (These are now available in your NX assembly after import)
   - CALC_Skid_Count
   - CALC_Skid_Pitch
   - CALC_First_Skid_Pos_X
   - INPUT_Skid_Nominal_Width
   - INPUT_Skid_Actual_Length  (Note: this is `crate_length_OD` in the .exp file)
   - INPUT_Skid_Nominal_Height

**B. Place and Define the First Skid Instance (Seed for Pattern):**
   1. Add one instance of `SKID_LUMBER_TEMPLATE.prt`.
   2. Link its internal expressions to assembly expressions:
      - Instance's `INPUT_Skid_Width`   = `INPUT_Skid_Nominal_Width`
      - Instance's `INPUT_Skid_Length`  = `INPUT_Skid_Actual_Length`
      - Instance's `INPUT_Skid_Height`  = `INPUT_Skid_Nominal_Height`
   3. Position its origin:
      - X-coordinate: `CALC_First_Skid_Pos_X`
      - Y-coordinate: `0` (assuming centered along length)
      - Z-coordinate: `0` (assuming skid origin is bottom face, at base of assembly)

**C. Create NX "Pattern Component" for Skids:**
   1. Select the first skid instance as the "Component to Pattern".
   2. Layout: Linear
   3. Direction 1: Assembly X-axis
   4. Spacing: "Count and Pitch"
      - Count: (Link to assembly expression) `CALC_Skid_Count`
      - Pitch Distance: (Link to assembly expression) `CALC_Skid_Pitch`

-------------------------------------------------------------------------
SECTION 2: FLOORBOARD SETUP (N-Instance Suppression Strategy)
-------------------------------------------------------------------------

**A. Key Assembly Expressions from `.exp` File (for Floorboards):**
   (These are now available in your NX assembly after import)
   - CALC_Floor_Board_Length_Across_Skids (= CALC_Overall_Skid_Span)
   - INPUT_Floorboard_Actual_Thickness   (= floor_lumbar_thickness from UI)
   - INPUT_Skid_Nominal_Height          (for Z-positioning)

   **For EACH of your pre-placed floorboard "slots" (e.g., for slot `FB_Std_Front_1`):**
   - `FB_Std_Front_1_Suppress_Flag`    (0 for ON, 1 for OFF)
   - `FB_Std_Front_1_Actual_Width`     (The Y-dimension for this specific board slot)
   - `FB_Std_Front_1_Y_Pos_Abs`        (Absolute Y-coordinate of the *leading edge* of this slot)
   (And similar for `FB_Std_Front_2_...`, `FB_Std_Back_1_...`, `FB_Custom_...`)

**B. Link Your Pre-Placed Floorboard Instances:**
   (Assuming your `FLOORBOARD_LUMBER_TEMPLATE.prt` origin is at the **center of its bottom face**)

   **For instance `FB_STD_FRONT_1` (example):**
   1. Link Dimensions:
      - Instance's `INPUT_Floorboard_Length_X`    = `CALC_Floor_Board_Length_Across_Skids`
      - Instance's `INPUT_Floorboard_Width_Y`   = `FB_Std_Front_1_Actual_Width`
      - Instance's `INPUT_Floorboard_Thickness_Z` = `INPUT_Floorboard_Actual_Thickness`
   2. Position its Origin:
      - X-coordinate: `0` (centered)
      - Z-coordinate: `INPUT_Skid_Nominal_Height` (on top of skids)
      - Y-coordinate: `FB_Std_Front_1_Y_Pos_Abs + (FB_Std_Front_1_Actual_Width / 2)`
   3. Link Suppression State:
      - Instance's Suppression Control = `1 - FB_Std_Front_1_Suppress_Flag`
        (This inverts the flag: if flag is 0 (visible in Python), expression is 1 (visible in NX).
         If flag is 1 (hidden in Python), expression is 0 (hidden in NX). Adjust if your NX suppression interpretation of 0/1 is different.)

   **Repeat for all other pre-placed floorboard instances/slots:**
   - For `FB_STD_FRONT_2`: Use `..._Front_2_...` expressions.
   - For `FB_STD_BACK_1`: Use `..._Back_1_...` expressions.
   - For `FB_CUSTOM_MIDDLE_1`: Use `FB_Custom_...` expressions.

-------------------------------------------------------------------------

**General Tips for Linking Expressions in NX:**
- When editing an expression's formula for an *instance* or a *constraint dimension*, you can often just type the name of the desired *assembly-level expression* (e.g., `CALC_Skid_Pitch`). NX will create the link.
- Double-check expression names for typos. They are case-sensitive.
- After linking, change a "USER CONTROL" in the main assembly's expressions (Ctrl+E) (e.g., `product_weight` or `product_length`), update the model, and verify that your skids and floorboards update correctly in size, position, and count/suppression.

Good luck with your CAD work for the meeting!